{"cells":[{"cell_type":"markdown","metadata":{},"source":["# Movie ranking (MovieLens Dataset)"]},{"cell_type":"markdown","metadata":{},"source":["Packages to load"]},{"cell_type":"code","execution_count":1,"metadata":{},"outputs":[],"source":["import pandas as pd\n","from apprate.app_movies.preparedata import create_movie_users\n","from apprate.datasets.filenames import MOVIELENS_SMALL_PATH, datasets_paths\n","from apprate.datasets.parse import create_pairs_data, parse_pairs_data\n","import apprate.ratings as ar\n","from apprate.utils.enums import ratings\n","from apprate.utils.methods import parse_columns"]},{"cell_type":"markdown","metadata":{},"source":["We consider only the movies which have been rated from 200 and more users"]},{"cell_type":"code","execution_count":2,"metadata":{},"outputs":[],"source":["MIN_VOTES = 200"]},{"cell_type":"markdown","metadata":{},"source":["Read data files"]},{"cell_type":"code","execution_count":3,"metadata":{},"outputs":[],"source":["filename_ratings, filename_movies = datasets_paths(\n","    MOVIELENS_SMALL_PATH+\"ratings.csv\", MOVIELENS_SMALL_PATH+\"movies.csv\")\n","\n","ratings_df = pd.read_csv(filename_ratings)\n","movies_df = pd.read_csv(filename_movies)"]},{"cell_type":"markdown","metadata":{},"source":["Data preparation"]},{"cell_type":"code","execution_count":4,"metadata":{},"outputs":[],"source":["user_movie_df, mr_df, movies_dict, id_titles_dict = create_movie_users(\n","    ratings_df, movies_df, min_votes=MIN_VOTES)"]},{"cell_type":"markdown","metadata":{},"source":["User-Movie dataframe"]},{"cell_type":"code","execution_count":5,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th>movieId</th>\n","      <th>1</th>\n","      <th>47</th>\n","      <th>50</th>\n","      <th>110</th>\n","      <th>150</th>\n","      <th>260</th>\n","      <th>296</th>\n","      <th>318</th>\n","      <th>356</th>\n","      <th>480</th>\n","      <th>527</th>\n","      <th>589</th>\n","      <th>593</th>\n","      <th>780</th>\n","      <th>1196</th>\n","      <th>2571</th>\n","      <th>2858</th>\n","      <th>2959</th>\n","    </tr>\n","    <tr>\n","      <th>userId</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>1</th>\n","      <td>4.0</td>\n","      <td>5.0</td>\n","      <td>5.0</td>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>3.0</td>\n","      <td>5.0</td>\n","      <td>5.0</td>\n","      <td>5.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.5</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>0.0</td>\n","      <td>2.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>1.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>1.0</td>\n","      <td>5.0</td>\n","      <td>2.0</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>4.0</td>\n","      <td>0.0</td>\n","      <td>4.0</td>\n","      <td>4.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>5.0</td>\n","      <td>3.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","      <td>0.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["movieId  1     47    50    110   150   260   296   318   356   480   527   \\\n","userId                                                                      \n","1         4.0   5.0   5.0   4.0   0.0   5.0   3.0   0.0   4.0   4.0   5.0   \n","2         0.0   0.0   0.0   0.0   0.0   0.0   0.0   3.0   0.0   0.0   0.0   \n","3         0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.0   0.5   \n","4         0.0   2.0   0.0   0.0   0.0   5.0   1.0   0.0   0.0   0.0   0.0   \n","5         4.0   0.0   4.0   4.0   3.0   0.0   5.0   3.0   0.0   0.0   5.0   \n","\n","movieId  589   593   780   1196  2571  2858  2959  \n","userId                                             \n","1         0.0   4.0   3.0   5.0   5.0   5.0   5.0  \n","2         0.0   0.0   0.0   0.0   0.0   0.0   0.0  \n","3         0.0   0.0   0.0   0.0   0.0   0.0   0.0  \n","4         0.0   5.0   0.0   5.0   1.0   5.0   2.0  \n","5         3.0   0.0   0.0   0.0   0.0   0.0   0.0  "]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["user_movie_df.head()"]},{"cell_type":"markdown","metadata":{},"source":["Create movie-movie dataframe. The columns of movie_movie dataframe are set in COLUMNS_MOVIE_DICT."]},{"cell_type":"code","execution_count":6,"metadata":{},"outputs":[],"source":["COLUMNS_MOVIE_DICT = {\n","    'item_i': 'MovieI',\n","    'item_j': 'MovieJ',\n","    'points_i': 'RatingI',\n","    'points_j': 'RatingJ'\n","}\n","movie_movie_df = create_pairs_data(\n","    user_movie_df, columns_dict=COLUMNS_MOVIE_DICT)\n","col_names = parse_columns(COLUMNS_MOVIE_DICT)"]},{"cell_type":"code","execution_count":7,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>MovieI</th>\n","      <th>MovieJ</th>\n","      <th>RatingI</th>\n","      <th>RatingJ</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>1.0</td>\n","      <td>47.0</td>\n","      <td>4.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>1.0</td>\n","      <td>47.0</td>\n","      <td>2.5</td>\n","      <td>3.5</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>1.0</td>\n","      <td>47.0</td>\n","      <td>4.5</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>1.0</td>\n","      <td>47.0</td>\n","      <td>3.5</td>\n","      <td>4.5</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>1.0</td>\n","      <td>47.0</td>\n","      <td>4.0</td>\n","      <td>3.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["    MovieI  MovieJ  RatingI  RatingJ\n","0      1.0    47.0      4.0      5.0\n","12     1.0    47.0      2.5      3.5\n","14     1.0    47.0      4.5      4.0\n","15     1.0    47.0      3.5      4.5\n","16     1.0    47.0      4.0      3.0"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["movie_movie_df.head()"]},{"cell_type":"markdown","metadata":{},"source":["We replace ids to titles"]},{"cell_type":"code","execution_count":8,"metadata":{},"outputs":[],"source":["movie_movie_df.replace({col_names.item_i: id_titles_dict,\n","                        col_names.item_j: id_titles_dict}, inplace=True)"]},{"cell_type":"code","execution_count":9,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>MovieI</th>\n","      <th>MovieJ</th>\n","      <th>RatingI</th>\n","      <th>RatingJ</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Toy Story (1995)</td>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>4.0</td>\n","      <td>5.0</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Toy Story (1995)</td>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>2.5</td>\n","      <td>3.5</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Toy Story (1995)</td>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>4.5</td>\n","      <td>4.0</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Toy Story (1995)</td>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>3.5</td>\n","      <td>4.5</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>4.0</td>\n","      <td>3.0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["              MovieI                       MovieJ  RatingI  RatingJ\n","0   Toy Story (1995)  Seven (a.k.a. Se7en) (1995)      4.0      5.0\n","12  Toy Story (1995)  Seven (a.k.a. Se7en) (1995)      2.5      3.5\n","14  Toy Story (1995)  Seven (a.k.a. Se7en) (1995)      4.5      4.0\n","15  Toy Story (1995)  Seven (a.k.a. Se7en) (1995)      3.5      4.5\n","16  Toy Story (1995)  Seven (a.k.a. Se7en) (1995)      4.0      3.0"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["movie_movie_df.head()"]},{"cell_type":"markdown","metadata":{},"source":["Convert movie-movie dataframe in pairs. This means that every pair is a hypothetical match."]},{"cell_type":"code","execution_count":10,"metadata":{},"outputs":[],"source":["data_df, items_df = parse_pairs_data(\n","    movie_movie_df, columns_dict=COLUMNS_MOVIE_DICT)"]},{"cell_type":"markdown","metadata":{},"source":["Winloss method"]},{"cell_type":"code","execution_count":11,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>0.487022</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>0.437293</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>0.434593</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>0.416114</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>0.399529</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>0.393139</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>0.389134</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>0.376181</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>0.375681</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>0.361991</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>0.357198</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>0.324009</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>0.308989</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>0.286781</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>0.250749</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>0.218831</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>0.213389</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>0.142087</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item    rating  ranking\n","11                   Shawshank Redemption, The (1994)  0.487022        1\n","3                                   Fight Club (1999)  0.437293        2\n","9                             Schindler's List (1993)  0.434593        3\n","8                                 Pulp Fiction (1994)  0.416114        4\n","7                                  Matrix, The (1999)  0.399529        5\n","14  Star Wars: Episode V - The Empire Strikes Back...  0.393139        6\n","17                         Usual Suspects, The (1995)  0.389134        7\n","4                                 Forrest Gump (1994)  0.376181        8\n","13          Star Wars: Episode IV - A New Hope (1977)  0.375681        9\n","0                              American Beauty (1999)  0.361991       10\n","12                   Silence of the Lambs, The (1991)  0.357198       11\n","10                        Seven (a.k.a. Se7en) (1995)  0.324009       12\n","2                                   Braveheart (1995)  0.308989       13\n","15                  Terminator 2: Judgment Day (1991)  0.286781       14\n","16                                   Toy Story (1995)  0.250749       15\n","1                                    Apollo 13 (1995)  0.218831       16\n","6                                Jurassic Park (1993)  0.213389       17\n","5                Independence Day (a.k.a. ID4) (1996)  0.142087       18"]},"execution_count":11,"metadata":{},"output_type":"execute_result"}],"source":["winloss = ar.Winloss(normalization=True).rate(data_df, items_df,\n","                                           columns_dict=COLUMNS_MOVIE_DICT,\n","                                           sort=True)\n","winloss"]},{"cell_type":"markdown","metadata":{},"source":["Colley method"]},{"cell_type":"code","execution_count":12,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>0.640853</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>0.601217</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>0.589744</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>0.580793</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>0.570784</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>0.563320</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>0.560407</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>0.557430</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>0.532597</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>0.526484</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>0.517829</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>0.481105</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>0.463452</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>0.443593</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>0.398126</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>0.367100</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>0.359229</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>0.245937</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item    rating  ranking\n","11                   Shawshank Redemption, The (1994)  0.640853        1\n","3                                   Fight Club (1999)  0.601217        2\n","9                             Schindler's List (1993)  0.589744        3\n","8                                 Pulp Fiction (1994)  0.580793        4\n","7                                  Matrix, The (1999)  0.570784        5\n","14  Star Wars: Episode V - The Empire Strikes Back...  0.563320        6\n","17                         Usual Suspects, The (1995)  0.560407        7\n","13          Star Wars: Episode IV - A New Hope (1977)  0.557430        8\n","4                                 Forrest Gump (1994)  0.532597        9\n","12                   Silence of the Lambs, The (1991)  0.526484       10\n","0                              American Beauty (1999)  0.517829       11\n","10                        Seven (a.k.a. Se7en) (1995)  0.481105       12\n","2                                   Braveheart (1995)  0.463452       13\n","15                  Terminator 2: Judgment Day (1991)  0.443593       14\n","16                                   Toy Story (1995)  0.398126       15\n","1                                    Apollo 13 (1995)  0.367100       16\n","6                                Jurassic Park (1993)  0.359229       17\n","5                Independence Day (a.k.a. ID4) (1996)  0.245937       18"]},"execution_count":12,"metadata":{},"output_type":"execute_result"}],"source":["colley = ar.Colley().rate(data_df, items_df,\n","                       columns_dict=COLUMNS_MOVIE_DICT, sort=True)\n","colley"]},{"cell_type":"markdown","metadata":{},"source":["Massey method"]},{"cell_type":"code","execution_count":13,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>0.346492</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>0.255608</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>0.220186</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>0.203028</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>0.188020</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>0.186607</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>0.172086</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>0.146320</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>0.120222</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>0.108683</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>0.043739</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>-0.039473</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>-0.087081</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>-0.130181</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>-0.225315</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>-0.353620</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>-0.363172</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>-0.792149</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item    rating  ranking\n","11                   Shawshank Redemption, The (1994)  0.346492        1\n","3                                   Fight Club (1999)  0.255608        2\n","9                             Schindler's List (1993)  0.220186        3\n","14  Star Wars: Episode V - The Empire Strikes Back...  0.203028        4\n","8                                 Pulp Fiction (1994)  0.188020        5\n","13          Star Wars: Episode IV - A New Hope (1977)  0.186607        6\n","17                         Usual Suspects, The (1995)  0.172086        7\n","7                                  Matrix, The (1999)  0.146320        8\n","12                   Silence of the Lambs, The (1991)  0.120222        9\n","4                                 Forrest Gump (1994)  0.108683       10\n","0                              American Beauty (1999)  0.043739       11\n","10                        Seven (a.k.a. Se7en) (1995) -0.039473       12\n","2                                   Braveheart (1995) -0.087081       13\n","15                  Terminator 2: Judgment Day (1991) -0.130181       14\n","16                                   Toy Story (1995) -0.225315       15\n","1                                    Apollo 13 (1995) -0.353620       16\n","6                                Jurassic Park (1993) -0.363172       17\n","5                Independence Day (a.k.a. ID4) (1996) -0.792149       18"]},"execution_count":13,"metadata":{},"output_type":"execute_result"}],"source":["massey = ar.Massey().rate(data_df, items_df,\n","                       columns_dict=COLUMNS_MOVIE_DICT, sort=True)\n","massey"]},{"cell_type":"markdown","metadata":{},"source":["Keener method"]},{"cell_type":"code","execution_count":14,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>0.069076</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>0.068681</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>0.067878</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>0.064320</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>0.064200</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>0.057823</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>0.056881</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>0.055209</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>0.054803</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>0.053423</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>0.053067</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>0.051755</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>0.051347</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>0.050845</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>0.050078</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>0.044521</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>0.043295</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>0.042799</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item    rating  ranking\n","9                             Schindler's List (1993)  0.069076        1\n","3                                   Fight Club (1999)  0.068681        2\n","17                         Usual Suspects, The (1995)  0.067878        3\n","14  Star Wars: Episode V - The Empire Strikes Back...  0.064320        4\n","0                              American Beauty (1999)  0.064200        5\n","13          Star Wars: Episode IV - A New Hope (1977)  0.057823        6\n","10                        Seven (a.k.a. Se7en) (1995)  0.056881        7\n","16                                   Toy Story (1995)  0.055209        8\n","11                   Shawshank Redemption, The (1994)  0.054803        9\n","1                                    Apollo 13 (1995)  0.053423       10\n","7                                  Matrix, The (1999)  0.053067       11\n","12                   Silence of the Lambs, The (1991)  0.051755       12\n","2                                   Braveheart (1995)  0.051347       13\n","15                  Terminator 2: Judgment Day (1991)  0.050845       14\n","8                                 Pulp Fiction (1994)  0.050078       15\n","4                                 Forrest Gump (1994)  0.044521       16\n","6                                Jurassic Park (1993)  0.043295       17\n","5                Independence Day (a.k.a. ID4) (1996)  0.042799       18"]},"execution_count":14,"metadata":{},"output_type":"execute_result"}],"source":["keener = ar.Keener(normalization=True).rate(data_df, items_df,\n","                                         columns_dict=COLUMNS_MOVIE_DICT,\n","                                         sort=True)\n","keener"]},{"cell_type":"markdown","metadata":{},"source":["Offense Defense method"]},{"cell_type":"code","execution_count":15,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>9959.064938</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>9723.111939</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>9667.969927</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>9663.789746</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>9632.871408</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>9619.374260</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>9551.967294</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>9485.607006</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>9413.009630</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>9406.346284</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>9293.036977</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>9047.212064</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>8875.408620</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>8785.973482</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>8635.668518</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>8339.634335</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>8330.205866</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>7231.557780</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item       rating  ranking\n","11                   Shawshank Redemption, The (1994)  9959.064938        1\n","3                                   Fight Club (1999)  9723.111939        2\n","14  Star Wars: Episode V - The Empire Strikes Back...  9667.969927        3\n","9                             Schindler's List (1993)  9663.789746        4\n","13          Star Wars: Episode IV - A New Hope (1977)  9632.871408        5\n","8                                 Pulp Fiction (1994)  9619.374260        6\n","7                                  Matrix, The (1999)  9551.967294        7\n","17                         Usual Suspects, The (1995)  9485.607006        8\n","4                                 Forrest Gump (1994)  9413.009630        9\n","12                   Silence of the Lambs, The (1991)  9406.346284       10\n","0                              American Beauty (1999)  9293.036977       11\n","10                        Seven (a.k.a. Se7en) (1995)  9047.212064       12\n","2                                   Braveheart (1995)  8875.408620       13\n","15                  Terminator 2: Judgment Day (1991)  8785.973482       14\n","16                                   Toy Story (1995)  8635.668518       15\n","1                                    Apollo 13 (1995)  8339.634335       16\n","6                                Jurassic Park (1993)  8330.205866       17\n","5                Independence Day (a.k.a. ID4) (1996)  7231.557780       18"]},"execution_count":15,"metadata":{},"output_type":"execute_result"}],"source":["od = ar.OffenseDefense(tol=0.0001).rate(data_df, items_df,\n","                                     columns_dict=COLUMNS_MOVIE_DICT, sort=True)\n","od"]},{"cell_type":"markdown","metadata":{},"source":["GeM (Markov) method - [voting with losses - for voting matrix]"]},{"cell_type":"code","execution_count":16,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>0.071243</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>0.068912</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>0.066676</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>0.062446</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>0.061244</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>0.057446</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>0.057326</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>0.055620</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>0.054730</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>0.051846</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>0.051558</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>0.050788</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>0.049611</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>0.049106</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>0.049058</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>0.048120</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>0.047808</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>0.046462</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item    rating  ranking\n","4                                 Forrest Gump (1994)  0.071243        1\n","8                                 Pulp Fiction (1994)  0.068912        2\n","11                   Shawshank Redemption, The (1994)  0.066676        3\n","12                   Silence of the Lambs, The (1991)  0.062446        4\n","7                                  Matrix, The (1999)  0.061244        5\n","6                                Jurassic Park (1993)  0.057446        6\n","13          Star Wars: Episode IV - A New Hope (1977)  0.057326        7\n","2                                   Braveheart (1995)  0.055620        8\n","15                  Terminator 2: Judgment Day (1991)  0.054730        9\n","14  Star Wars: Episode V - The Empire Strikes Back...  0.051846       10\n","10                        Seven (a.k.a. Se7en) (1995)  0.051558       11\n","3                                   Fight Club (1999)  0.050788       12\n","9                             Schindler's List (1993)  0.049611       13\n","17                         Usual Suspects, The (1995)  0.049106       14\n","5                Independence Day (a.k.a. ID4) (1996)  0.049058       15\n","16                                   Toy Story (1995)  0.048120       16\n","0                              American Beauty (1999)  0.047808       17\n","1                                    Apollo 13 (1995)  0.046462       18"]},"execution_count":16,"metadata":{},"output_type":"execute_result"}],"source":["voting_losses_dict = {\n","    'ratings': {'VOTE': 10,\n","                'ITEM_I': col_names.points_i,\n","                'ITEM_J': col_names.points_i,\n","                'METHOD': 'VotingWithLosses'}\n","}\n","\n","markov_vl = ar.Markov(stats_markov_dict=voting_losses_dict).rate(\n","    data_df, items_df,\n","    columns_dict=COLUMNS_MOVIE_DICT, sort=True)\n","markov_vl"]},{"cell_type":"markdown","metadata":{},"source":["GeM (Markov) method - [winners and losers vote point - for voting matrix]"]},{"cell_type":"code","execution_count":17,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>0.072198</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>0.071079</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>0.069939</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>0.063311</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>0.061210</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>0.058615</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>0.055543</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>0.054777</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>0.054550</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>0.051972</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>0.050947</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>0.050662</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>0.050617</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>0.050435</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>0.047533</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>0.047106</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>0.045610</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>0.043895</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item    rating  ranking\n","4                                 Forrest Gump (1994)  0.072198        1\n","8                                 Pulp Fiction (1994)  0.071079        2\n","11                   Shawshank Redemption, The (1994)  0.069939        3\n","12                   Silence of the Lambs, The (1991)  0.063311        4\n","7                                  Matrix, The (1999)  0.061210        5\n","13          Star Wars: Episode IV - A New Hope (1977)  0.058615        6\n","6                                Jurassic Park (1993)  0.055543        7\n","2                                   Braveheart (1995)  0.054777        8\n","15                  Terminator 2: Judgment Day (1991)  0.054550        9\n","14  Star Wars: Episode V - The Empire Strikes Back...  0.051972       10\n","17                         Usual Suspects, The (1995)  0.050947       11\n","10                        Seven (a.k.a. Se7en) (1995)  0.050662       12\n","3                                   Fight Club (1999)  0.050617       13\n","9                             Schindler's List (1993)  0.050435       14\n","0                              American Beauty (1999)  0.047533       15\n","5                Independence Day (a.k.a. ID4) (1996)  0.047106       16\n","16                                   Toy Story (1995)  0.045610       17\n","1                                    Apollo 13 (1995)  0.043895       18"]},"execution_count":17,"metadata":{},"output_type":"execute_result"}],"source":["voting_points_dict = {\n","    'ratings': {'VOTE': 10,\n","                'ITEM_I': col_names.points_i,\n","                'ITEM_J': col_names.points_i,\n","                'METHOD': 'WinnersAndLosersVotePoint'}\n","}\n","\n","markov_vp = ar.Markov(stats_markov_dict=voting_points_dict).rate(\n","    data_df, items_df,\n","    columns_dict=COLUMNS_MOVIE_DICT, sort=True)\n","markov_vp"]},{"cell_type":"markdown","metadata":{},"source":["We create a dictionary in order to compare ranking lists with Kendall Tau"]},{"cell_type":"code","execution_count":18,"metadata":{},"outputs":[{"name":"stdout","output_type":"stream","text":["          winloss    colley    massey   keener        od markov_vl markov_vp\n","winloss       1.0  5.31e-14  2.96e-10   0.0137  2.96e-10     0.131    0.0959\n","colley      0.974       1.0  2.93e-11   0.0137  2.93e-11     0.131    0.0959\n","massey      0.895     0.922       1.0  0.00514  1.81e-12     0.229     0.175\n","keener      0.425     0.425     0.477      1.0   0.00854    0.0813     0.112\n","od          0.895     0.922     0.948    0.451       1.0     0.175     0.131\n","markov_vl   0.268     0.268     0.216   -0.307     0.242       1.0  2.93e-11\n","markov_vp   0.294     0.294     0.242   -0.281     0.268     0.922       1.0\n"]}],"source":["ratings_dict = {\n","    'winloss': winloss.sort_values(by='Item'),\n","    'colley': colley.sort_values(by='Item'),\n","    'massey': massey.sort_values(by='Item'),\n","    'keener': keener.sort_values(by='Item'),\n","    'od': od.sort_values(by='Item'),\n","    'markov_vl': markov_vl.sort_values(by='Item'),\n","    'markov_vp': markov_vp.sort_values(by='Item')\n","}\n","kendall_tau_results = ar.metrics.kendall_tau_table(\n","    ratings_dict=ratings_dict, print_out=True)"]},{"cell_type":"markdown","metadata":{},"source":["We aggregate rating values into one rating list by applying Perron method"]},{"cell_type":"code","execution_count":19,"metadata":{},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>Item</th>\n","      <th>rating</th>\n","      <th>ranking</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>11</th>\n","      <td>Shawshank Redemption, The (1994)</td>\n","      <td>0.165374</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>8</th>\n","      <td>Pulp Fiction (1994)</td>\n","      <td>0.110949</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Forrest Gump (1994)</td>\n","      <td>0.102073</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Fight Club (1999)</td>\n","      <td>0.093078</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>9</th>\n","      <td>Schindler's List (1993)</td>\n","      <td>0.085109</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>7</th>\n","      <td>Matrix, The (1999)</td>\n","      <td>0.064785</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>14</th>\n","      <td>Star Wars: Episode V - The Empire Strikes Back...</td>\n","      <td>0.061945</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>17</th>\n","      <td>Usual Suspects, The (1995)</td>\n","      <td>0.061473</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>13</th>\n","      <td>Star Wars: Episode IV - A New Hope (1977)</td>\n","      <td>0.059843</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>12</th>\n","      <td>Silence of the Lambs, The (1991)</td>\n","      <td>0.058304</td>\n","      <td>10</td>\n","    </tr>\n","    <tr>\n","      <th>0</th>\n","      <td>American Beauty (1999)</td>\n","      <td>0.039621</td>\n","      <td>11</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Braveheart (1995)</td>\n","      <td>0.022026</td>\n","      <td>12</td>\n","    </tr>\n","    <tr>\n","      <th>10</th>\n","      <td>Seven (a.k.a. Se7en) (1995)</td>\n","      <td>0.021337</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>15</th>\n","      <td>Terminator 2: Judgment Day (1991)</td>\n","      <td>0.018664</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>6</th>\n","      <td>Jurassic Park (1993)</td>\n","      <td>0.018577</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>16</th>\n","      <td>Toy Story (1995)</td>\n","      <td>0.010273</td>\n","      <td>16</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Apollo 13 (1995)</td>\n","      <td>0.006151</td>\n","      <td>17</td>\n","    </tr>\n","    <tr>\n","      <th>5</th>\n","      <td>Independence Day (a.k.a. ID4) (1996)</td>\n","      <td>0.000417</td>\n","      <td>18</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>"],"text/plain":["                                                 Item    rating  ranking\n","11                   Shawshank Redemption, The (1994)  0.165374        1\n","8                                 Pulp Fiction (1994)  0.110949        2\n","4                                 Forrest Gump (1994)  0.102073        3\n","3                                   Fight Club (1999)  0.093078        4\n","9                             Schindler's List (1993)  0.085109        5\n","7                                  Matrix, The (1999)  0.064785        6\n","14  Star Wars: Episode V - The Empire Strikes Back...  0.061945        7\n","17                         Usual Suspects, The (1995)  0.061473        8\n","13          Star Wars: Episode IV - A New Hope (1977)  0.059843        9\n","12                   Silence of the Lambs, The (1991)  0.058304       10\n","0                              American Beauty (1999)  0.039621       11\n","2                                   Braveheart (1995)  0.022026       12\n","10                        Seven (a.k.a. Se7en) (1995)  0.021337       13\n","15                  Terminator 2: Judgment Day (1991)  0.018664       14\n","6                                Jurassic Park (1993)  0.018577       15\n","16                                   Toy Story (1995)  0.010273       16\n","1                                    Apollo 13 (1995)  0.006151       17\n","5                Independence Day (a.k.a. ID4) (1996)  0.000417       18"]},"execution_count":19,"metadata":{},"output_type":"execute_result"}],"source":["ra = ar.RatingAggregation(ratings.AGGREGATIONPERRON)\n","\n","ratings_aggr_dict = {\n","    'Item': items_df['Item'].values,\n","    'winloss': winloss.sort_values(by='Item').rating.values,\n","    'colley': colley.sort_values(by='Item').rating.values,\n","    'massey': massey.sort_values(by='Item').rating.values,\n","    'keener': keener.sort_values(by='Item').rating.values,\n","    'od': od.sort_values(by='Item').rating.values,\n","    'markov_vl': markov_vl.sort_values(by='Item').rating.values,\n","    'markov_vp': markov_vp.sort_values(by='Item').rating.values\n","}\n","columns_dict = {'item': 'Item',\n","                'ratings': list(ratings_aggr_dict.keys()-{'Item'})}\n","data_df = pd.DataFrame.from_dict(ratings_aggr_dict)\n","movies_aggr_df = ra.rate(data_df, items_df, columns_dict=columns_dict, sort=True)\n","movies_aggr_df\n"]}],"metadata":{"kernelspec":{"display_name":"Python 3.8.13 ('py38')","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.13"},"orig_nbformat":4,"vscode":{"interpreter":{"hash":"23ceb7112fbf9d0e38ecbf60d6e6d5e2dcebcc82200eeb1e5a5d5f9ffb9e27ca"}}},"nbformat":4,"nbformat_minor":2}
